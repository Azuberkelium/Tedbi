<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TedBi's PT Game</title>
    <!-- Use Tailwind CSS for a clean, mobile-first design -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Use Inter font for a modern and readable look -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        /* Custom CSS for the periodic table grid and elements */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0d1117;
            color: #c9d1d9;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        .periodic-table-grid {
            display: grid;
            grid-template-columns: repeat(18, 1fr);
            gap: 4px;
        }

        .element-tile {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 8px;
            text-align: center;
            cursor: pointer;
            border-radius: 8px;
            background-color: #21262d;
            border: 2px solid #30363d;
            transition: all 0.2s ease-in-out;
            aspect-ratio: 1 / 1;
        }

        .element-tile:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .element-symbol {
            font-size: 1.5rem;
            font-weight: bold;
            line-height: 1;
        }

        .element-number {
            font-size: 0.75rem;
            opacity: 0.7;
        }

        .element-name {
            font-size: 0.65rem;
            opacity: 0.9;
        }

        /* Styling for interactive elements */
        .active-element {
            background-color: #2e5c46; /* A green color to indicate it can form a compound */
            border-color: #55a687;
        }

        .selected-element {
            background-color: #3b82f6; /* A blue color to indicate it's currently selected */
            border-color: #60a5fa;
            transform: scale(1.05);
        }

        .lanthanide-link, .actinide-link {
            cursor: pointer;
            transition: color 0.2s;
        }

        .lanthanide-link:hover, .actinide-link:hover {
            color: #3b82f6;
        }
        
        /* The Lanthanide and Actinide series are initially hidden and get their own rows when clicked */
        .lanthanide, .actinide {
            grid-column-start: 4 !important;
        }
        
        /* Pulse animation for elements in the mix zone */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .mix-element {
            animation: pulse 1s infinite;
        }

        /* Modal styling for the Recipe Book and Info Panel */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.75);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal-content {
            background-color: #161b22;
            padding: 2rem;
            border-radius: 12px;
            max-width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            border: 2px solid #30363d;
            position: relative;
        }

        /* Responsive design adjustments for smaller screens */
        @media (max-width: 1024px) {
            .periodic-table-grid {
                grid-template-columns: repeat(10, 1fr);
            }
            .lanthanide, .actinide {
                grid-column-start: 1 !important;
            }
            .main-container {
                flex-direction: column;
                padding: 1rem;
            }
        }
    </style>
</head>
<body class="p-4">

    <main class="main-container flex flex-col lg:flex-row w-full max-w-7xl mx-auto gap-8">

        <!-- Left side: Periodic Table -->
        <div class="flex-1">
            <h1 class="text-3xl font-bold text-center mb-6">TedBi's PT Game</h1>
            <div class="flex justify-between items-center mb-4">
                <button id="show-info-button" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-xl shadow-lg transition-all">
                    Info
                </button>
            </div>
            <div id="periodic-table-container" class="periodic-table-grid">
                <!-- Elements will be generated here by JavaScript -->
            </div>
            <div class="mt-4 flex justify-between text-xs sm:text-base">
                <span id="lanthanide-link" class="lanthanide-link">57-71 * Lanthanides</span>
                <span id="actinide-link" class="actinide-link">89-103 ** Actinides</span>
            </div>
        </div>

        <!-- Right side: Information and Mix Zone -->
        <div class="lg:w-1/3 flex flex-col gap-6">
            <!-- Stats Panel -->
            <div id="info-panel" class="bg-gray-800 p-6 rounded-xl shadow-lg border-2 border-gray-700">
                <h2 class="text-2xl font-semibold mb-4 text-white">Element Information</h2>
                <p id="info-message" class="text-gray-400">Click on an element to see its stats.</p>
                <div id="element-stats" class="space-y-2 hidden">
                    <p><strong>Name:</strong> <span id="stat-name"></span></p>
                    <p><strong>Symbol:</strong> <span id="stat-symbol"></span></p>
                    <p><strong>Atomic Number:</strong> <span id="stat-number"></span></p>
                    <p><strong>Atomic Mass:</strong> <span id="stat-mass"></span></p>
                    <p><strong>Category:</strong> <span id="stat-category"></span></p>
                </div>
            </div>

            <!-- Mix Zone -->
            <div id="mix-zone" class="bg-gray-800 p-6 rounded-xl shadow-lg border-2 border-gray-700">
                <h2 class="text-2xl font-semibold mb-4 text-white">Mix Zone</h2>
                <div id="compound-container" class="flex flex-wrap items-center gap-4 min-h-[6rem] p-2 rounded-lg bg-gray-900 border-2 border-dashed border-gray-600">
                    <p id="mix-message" class="text-gray-400 text-sm">Click an active element to add it here.</p>
                </div>
                <div id="compound-info" class="mt-4 hidden bg-gray-700 p-4 rounded-lg">
                    <h3 class="text-xl font-bold text-white">Compound: <span id="compound-name"></span></h3>
                    <p id="compound-formula" class="text-lg text-white my-2"></p>
                    <p id="compound-description" class="text-gray-300"></p>
                </div>
                <div class="mt-6 flex flex-col sm:flex-row gap-4">
                    <button id="show-recipes-button" class="flex-1 bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-xl shadow-lg transition-all">
                        Show Recipes
                    </button>
                    <button id="reset-button" class="flex-1 bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-4 rounded-xl shadow-lg transition-all">
                        Reset Mix Zone
                    </button>
                </div>
            </div>
        </div>

    </main>

    <!-- Recipe Book Modal -->
    <div id="recipe-book-modal" class="modal-overlay hidden">
        <div class="modal-content w-full max-w-lg">
            <div class="flex justify-between items-center mb-4 border-b pb-2 border-gray-600">
                <h2 class="text-2xl font-bold text-white">Compound Recipes</h2>
                <button id="close-recipes-modal-button" class="text-gray-400 hover:text-white text-3xl font-bold leading-none">&times;</button>
            </div>
            <ul id="recipes-list" class="space-y-4">
                <!-- Recipes will be dynamically added here -->
            </ul>
        </div>
    </div>

    <!-- Info Panel Modal -->
    <div id="info-modal" class="modal-overlay hidden">
        <div class="modal-content w-full max-w-2xl">
            <div class="flex justify-between items-center mb-4 border-b pb-2 border-gray-600">
                <h2 class="text-2xl font-bold text-white">About the Periodic Table</h2>
                <button id="close-info-modal-button" class="text-gray-400 hover:text-white text-3xl font-bold leading-none">&times;</button>
            </div>
            <div class="prose max-w-none text-gray-300">
                <p>Everything we know of is made up of one or more elements. We order these elements in something called the periodic table.</p>
                <p class="mt-2">The elements are grouped by atomic structure; this also means that elements that behave similarly are grouped together. Each element is made up of protons, neutrons and electrons.</p>
                <p class="mt-2">Each element has its own atomic structure, and some of these structures easily form new bonds or break bonds with other elements.</p>
                
                <h3 class="text-lg font-semibold mt-4 text-white">Periods and Groups</h3>
                <p class="mt-2">The rows of the table are called <strong>periods</strong>, hence the name!</p>
                <p class="mt-2">You'll notice that some of the rows aren't full. There are gaps in the rows because the elements are ordered by their atomic shells, from left to right. Atomic shells are the regions of space where electrons live. In general, there are only a certain amount of electrons per shell before it must have a new or outer shell.</p>
                <p class="mt-2">The periodic table also has vertical columns, and these are called <strong>groups</strong>. Each element in each column has the same number of electrons in its atomic outer shell.</p>
                
                <h3 class="text-lg font-semibold mt-4 text-white">Unique Elements</h3>
                <p class="mt-2">Hydrogen and helium are unique. Hydrogen has one electron in its outer shell. It always wants to bond with another element to add its electrons to its own.</p>
                <p class="mt-2">Helium has two electrons in its outer shell and is very stable — it doesn't want any more electrons.</p>
                <p class="mt-2">The columns of the periodic table are often used to define families. The noble gases are all located in the far-right column of the table. That column is labelled Group Zero.</p>
            </div>
        </div>
    </div>

    <!-- The JavaScript is moved to the end of the body for better reliability in preview environments -->
    <script>
        // Log to the console to confirm the script is running
        console.log("Game script loaded successfully.");

        // The core data for the periodic table
        // This is a simplified list to demonstrate the compound-forming functionality
        const elements = [
            // Row 1
            { name: "Hydrogen", symbol: "H", number: 1, atomic_mass: "1.008", category: "nonmetal", xpos: 1, ypos: 1, can_form_compound: true, compounds: [{ with: "O", formula: "H₂O", compound_info: "Water, a fundamental molecule for life." }, { with: "C", formula: "CH₄", compound_info: "Methane, the main component of natural gas." }, { with: "N", formula: "NH₃", compound_info: "Ammonia, a colorless gas with a pungent smell." }, { with: "Cl", formula: "HCl", compound_info: "Hydrochloric acid, a strong acid used in industry and found in stomach acid." }, { with: "O", formula: "H₂O₂", compound_info: "Hydrogen peroxide, a clear liquid used as an antiseptic." }] },
            { name: "Helium", symbol: "He", number: 2, atomic_mass: "4.0026", category: "noble gas", xpos: 18, ypos: 1, can_form_compound: false },
            // Row 2
            { name: "Lithium", symbol: "Li", number: 3, atomic_mass: "6.94", category: "alkali metal", xpos: 1, ypos: 2, can_form_compound: true, compounds: [{ with: "O", formula: "Li₂O", compound_info: "Lithium oxide, an inorganic compound." }, { with: "F", formula: "LiF", compound_info: "Lithium fluoride, an inorganic compound." }] },
            { name: "Beryllium", symbol: "Be", number: 4, atomic_mass: "9.0122", category: "alkaline earth metal", xpos: 2, ypos: 2, can_form_compound: false },
            { name: "Boron", symbol: "B", number: 5, atomic_mass: "10.81", category: "metalloid", xpos: 13, ypos: 2, can_form_compound: false },
            { name: "Carbon", symbol: "C", number: 6, atomic_mass: "12.011", category: "nonmetal", xpos: 14, ypos: 2, can_form_compound: true, compounds: [{ with: "O", formula: "CO₂", compound_info: "Carbon dioxide, a gas essential for plant photosynthesis." }, { with: "O", formula: "CO", compound_info: "Carbon monoxide, a colorless, odorless gas." }, { with: "H", formula: "CH₄", compound_info: "Methane, the main component of natural gas." }] },
            { name: "Nitrogen", symbol: "N", number: 7, atomic_mass: "14.007", category: "nonmetal", xpos: 15, ypos: 2, can_form_compound: true, compounds: [{ with: "H", formula: "NH₃", compound_info: "Ammonia, a colorless gas with a pungent smell." }] },
            { name: "Oxygen", symbol: "O", number: 8, atomic_mass: "15.999", category: "nonmetal", xpos: 16, ypos: 2, can_form_compound: true, compounds: [{ with: "H", formula: "H₂O", compound_info: "Water, a fundamental molecule for life." }, { with: "C", formula: "CO₂", compound_info: "Carbon dioxide, a gas essential for plant photosynthesis." }, { with: "C", formula: "CO", compound_info: "Carbon monoxide, a colorless, odorless gas." }, { with: "H", formula: "H₂O₂", compound_info: "Hydrogen peroxide, a clear liquid used as an antiseptic." }, { with: "Li", formula: "Li₂O", compound_info: "Lithium oxide, an inorganic compound." }, { with: "Na", formula: "Na₂O", compound_info: "Sodium oxide, a colorless solid." }] },
            { name: "Fluorine", symbol: "F", number: 9, atomic_mass: "18.998", category: "halogen", xpos: 17, ypos: 2, can_form_compound: true, compounds: [{ with: "Li", formula: "LiF", compound_info: "Lithium fluoride, an inorganic compound." }] },
            { name: "Neon", symbol: "Ne", number: 10, atomic_mass: "20.180", category: "noble gas", xpos: 18, ypos: 2, can_form_compound: false },
            // Row 3
            { name: "Sodium", symbol: "Na", number: 11, atomic_mass: "22.990", category: "alkali metal", xpos: 1, ypos: 3, can_form_compound: true, compounds: [{ with: "Cl", formula: "NaCl", compound_info: "Sodium Chloride, commonly known as table salt." }, { with: "O", formula: "Na₂O", compound_info: "Sodium oxide, a colorless solid." }] },
            { name: "Magnesium", symbol: "Mg", number: 12, atomic_mass: "24.305", category: "alkaline earth metal", xpos: 2, ypos: 3, can_form_compound: true, compounds: [{ with: "Cl", formula: "MgCl₂", compound_info: "Magnesium chloride, an ionic compound." }] },
            { name: "Aluminum", symbol: "Al", number: 13, atomic_mass: "26.982", category: "post-transition metal", xpos: 13, ypos: 3, can_form_compound: false },
            { name: "Silicon", symbol: "Si", number: 14, atomic_mass: "28.085", category: "metalloid", xpos: 14, ypos: 3, can_form_compound: false },
            { name: "Phosphorus", symbol: "P", number: 15, atomic_mass: "30.974", category: "nonmetal", xpos: 15, ypos: 3, can_form_compound: false },
            { name: "Sulfur", symbol: "S", number: 16, atomic_mass: "32.06", category: "nonmetal", xpos: 16, ypos: 3, can_form_compound: false },
            { name: "Chlorine", symbol: "Cl", number: 17, atomic_mass: "35.45", category: "halogen", xpos: 17, ypos: 3, can_form_compound: true, compounds: [{ with: "Na", formula: "NaCl", compound_info: "Sodium Chloride, commonly known as table salt." }, { with: "H", formula: "HCl", compound_info: "Hydrochloric acid, a strong acid used in industry and found in stomach acid." }, { with: "Mg", formula: "MgCl₂", compound_info: "Magnesium chloride, an ionic compound." }] },
            { name: "Argon", symbol: "Ar", number: 18, atomic_mass: "39.948", category: "noble gas", xpos: 18, ypos: 3, can_form_compound: false },
            // Rows 4-7, just placeholders to fill the table
            { name: "Potassium", symbol: "K", number: 19, atomic_mass: "39.098", category: "alkali metal", xpos: 1, ypos: 4, can_form_compound: false },
            { name: "Calcium", symbol: "Ca", number: 20, atomic_mass: "40.078", category: "alkaline earth metal", xpos: 2, ypos: 4, can_form_compound: false },
            { name: "Scandium", symbol: "Sc", number: 21, atomic_mass: "44.956", category: "transition metal", xpos: 3, ypos: 4, can_form_compound: false },
            { name: "Titanium", symbol: "Ti", number: 22, atomic_mass: "47.867", category: "transition metal", xpos: 4, ypos: 4, can_form_compound: false },
            { name: "Vanadium", symbol: "V", number: 23, atomic_mass: "50.942", category: "transition metal", xpos: 5, ypos: 4, can_form_compound: false },
            { name: "Chromium", symbol: "Cr", number: 24, atomic_mass: "51.996", category: "transition metal", xpos: 6, ypos: 4, can_form_compound: false },
            { name: "Manganese", symbol: "Mn", number: 25, atomic_mass: "54.938", category: "transition metal", xpos: 7, ypos: 4, can_form_compound: false },
            { name: "Iron", symbol: "Fe", number: 26, atomic_mass: "55.845", category: "transition metal", xpos: 8, ypos: 4, can_form_compound: false },
            { name: "Cobalt", symbol: "Co", number: 27, atomic_mass: "58.933", category: "transition metal", xpos: 9, ypos: 4, can_form_compound: false },
            { name: "Nickel", symbol: "Ni", number: 28, atomic_mass: "58.693", category: "transition metal", xpos: 10, ypos: 4, can_form_compound: false },
            { name: "Copper", symbol: "Cu", number: 29, atomic_mass: "63.546", category: "transition metal", xpos: 11, ypos: 4, can_form_compound: false },
            { name: "Zinc", symbol: "Zn", number: 30, atomic_mass: "65.38", category: "transition metal", xpos: 12, ypos: 4, can_form_compound: false },
            { name: "Gallium", symbol: "Ga", number: 31, atomic_mass: "69.723", category: "post-transition metal", xpos: 13, ypos: 4, can_form_compound: false },
            { name: "Germanium", symbol: "Ge", number: 32, atomic_mass: "72.630", category: "metalloid", xpos: 14, ypos: 4, can_form_compound: false },
            { name: "Arsenic", symbol: "As", number: 33, atomic_mass: "74.922", category: "metalloid", xpos: 15, ypos: 4, can_form_compound: false },
            { name: "Selenium", symbol: "Se", number: 34, atomic_mass: "78.971", category: "nonmetal", xpos: 16, ypos: 4, can_form_compound: false },
            { name: "Bromine", symbol: "Br", number: 35, atomic_mass: "79.904", category: "halogen", xpos: 17, ypos: 4, can_form_compound: false },
            { name: "Krypton", symbol: "Kr", number: 36, atomic_mass: "83.798", category: "noble gas", xpos: 18, ypos: 4, can_form_compound: false },
            // Row 5
            { name: "Rubidium", symbol: "Rb", number: 37, atomic_mass: "85.468", category: "alkali metal", xpos: 1, ypos: 5, can_form_compound: false },
            { name: "Strontium", symbol: "Sr", number: 38, atomic_mass: "87.62", category: "alkaline earth metal", xpos: 2, ypos: 5, can_form_compound: false },
            { name: "Yttrium", symbol: "Y", number: 39, atomic_mass: "88.906", category: "transition metal", xpos: 3, ypos: 5, can_form_compound: false },
            { name: "Zirconium", symbol: "Zr", number: 40, atomic_mass: "91.224", category: "transition metal", xpos: 4, ypos: 5, can_form_compound: false },
            { name: "Niobium", symbol: "Nb", number: 41, atomic_mass: "92.906", category: "transition metal", xpos: 5, ypos: 5, can_form_compound: false },
            { name: "Molybdenum", symbol: "Mo", number: 42, atomic_mass: "95.95", category: "transition metal", xpos: 6, ypos: 5, can_form_compound: false },
            { name: "Technetium", symbol: "Tc", number: 43, atomic_mass: "[98]", category: "transition metal", xpos: 7, ypos: 5, can_form_compound: false },
            { name: "Ruthenium", symbol: "Ru", number: 44, atomic_mass: "101.07", category: "transition metal", xpos: 8, ypos: 5, can_form_compound: false },
            { name: "Rhodium", symbol: "Rh", number: 45, atomic_mass: "102.91", category: "transition metal", xpos: 9, ypos: 5, can_form_compound: false },
            { name: "Palladium", symbol: "Pd", number: 46, atomic_mass: "106.42", category: "transition metal", xpos: 10, ypos: 5, can_form_compound: false },
            { name: "Silver", symbol: "Ag", number: 47, atomic_mass: "107.87", category: "transition metal", xpos: 11, ypos: 5, can_form_compound: false },
            { name: "Cadmium", symbol: "Cd", number: 48, atomic_mass: "112.41", category: "transition metal", xpos: 12, ypos: 5, can_form_compound: false },
            { name: "Indium", symbol: "In", number: 49, atomic_mass: "114.82", category: "post-transition metal", xpos: 13, ypos: 5, can_form_compound: false },
            { name: "Tin", symbol: "Sn", number: 50, atomic_mass: "118.71", category: "post-transition metal", xpos: 14, ypos: 5, can_form_compound: false },
            { name: "Antimony", symbol: "Sb", number: 51, atomic_mass: "121.76", category: "metalloid", xpos: 15, ypos: 5, can_form_compound: false },
            { name: "Tellurium", symbol: "Te", number: 52, atomic_mass: "127.60", category: "metalloid", xpos: 16, ypos: 5, can_form_compound: false },
            { name: "Iodine", symbol: "I", number: 53, atomic_mass: "126.90", category: "halogen", xpos: 17, ypos: 5, can_form_compound: false },
            { name: "Xenon", symbol: "Xe", number: 54, atomic_mass: "131.29", category: "noble gas", xpos: 18, ypos: 5, can_form_compound: false },
            // Row 6
            { name: "Cesium", symbol: "Cs", number: 55, atomic_mass: "132.91", category: "alkali metal", xpos: 1, ypos: 6, can_form_compound: false },
            { name: "Barium", symbol: "Ba", number: 56, atomic_mass: "137.33", category: "alkaline earth metal", xpos: 2, ypos: 6, can_form_compound: false },
            { name: "Lanthanum", symbol: "La", number: 57, atomic_mass: "138.91", category: "lanthanide", xpos: 3, ypos: 6, can_form_compound: false },
            { name: "Hafnium", symbol: "Hf", number: 72, atomic_mass: "178.49", category: "transition metal", xpos: 4, ypos: 6, can_form_compound: false },
            { name: "Tantalum", symbol: "Ta", number: 73, atomic_mass: "180.95", category: "transition metal", xpos: 5, ypos: 6, can_form_compound: false },
            { name: "Tungsten", symbol: "W", number: 74, atomic_mass: "183.84", category: "transition metal", xpos: 6, ypos: 6, can_form_compound: false },
            { name: "Rhenium", symbol: "Re", number: 75, atomic_mass: "186.21", category: "transition metal", xpos: 7, ypos: 6, can_form_compound: false },
            { name: "Osmium", symbol: "Os", number: 76, atomic_mass: "190.23", category: "transition metal", xpos: 8, ypos: 6, can_form_compound: false },
            { name: "Iridium", symbol: "Ir", number: 77, atomic_mass: "192.22", category: "transition metal", xpos: 9, ypos: 6, can_form_compound: false },
            { name: "Platinum", symbol: "Pt", number: 78, atomic_mass: "195.08", category: "transition metal", xpos: 10, ypos: 6, can_form_compound: false },
            { name: "Gold", symbol: "Au", number: 79, atomic_mass: "196.97", category: "transition metal", xpos: 11, ypos: 6, can_form_compound: false },
            { name: "Mercury", symbol: "Hg", number: 80, atomic_mass: "200.59", category: "transition metal", xpos: 12, ypos: 6, can_form_compound: false },
            { name: "Thallium", symbol: "Tl", number: 81, atomic_mass: "204.38", category: "post-transition metal", xpos: 13, ypos: 6, can_form_compound: false },
            { name: "Lead", symbol: "Pb", number: 82, atomic_mass: "207.2", category: "post-transition metal", xpos: 14, ypos: 6, can_form_compound: false },
            { name: "Bismuth", symbol: "Bi", number: 83, atomic_mass: "208.98", category: "post-transition metal", xpos: 15, ypos: 6, can_form_compound: false },
            { name: "Polonium", symbol: "Po", number: 84, atomic_mass: "[209]", category: "metalloid", xpos: 16, ypos: 6, can_form_compound: false },
            { name: "Astatine", symbol: "At", number: 85, atomic_mass: "[210]", category: "halogen", xpos: 17, ypos: 6, can_form_compound: false },
            { name: "Radon", symbol: "Rn", number: 86, atomic_mass: "[222]", category: "noble gas", xpos: 18, ypos: 6, can_form_compound: false },
            // Row 7
            { name: "Francium", symbol: "Fr", number: 87, atomic_mass: "[223]", category: "alkali metal", xpos: 1, ypos: 7, can_form_compound: false },
            { name: "Radium", symbol: "Ra", number: 88, atomic_mass: "[226]", category: "alkaline earth metal", xpos: 2, ypos: 7, can_form_compound: false },
            { name: "Actinium", symbol: "Ac", number: 89, atomic_mass: "[227]", category: "actinide", xpos: 3, ypos: 7, can_form_compound: false },
            { name: "Rutherfordium", symbol: "Rf", number: 104, atomic_mass: "[267]", category: "transition metal", xpos: 4, ypos: 7, can_form_compound: false },
            { name: "Dubnium", symbol: "Db", number: 105, atomic_mass: "[268]", category: "transition metal", xpos: 5, ypos: 7, can_form_compound: false },
            { name: "Seaborgium", symbol: "Sg", number: 106, atomic_mass: "[269]", category: "transition metal", xpos: 6, ypos: 7, can_form_compound: false },
            { name: "Bohrium", symbol: "Bh", number: 107, atomic_mass: "[270]", category: "transition metal", xpos: 7, ypos: 7, can_form_compound: false },
            { name: "Hassium", symbol: "Hs", number: 108, atomic_mass: "[269]", category: "transition metal", xpos: 8, ypos: 7, can_form_compound: false },
            { name: "Meitnerium", symbol: "Mt", number: 109, atomic_mass: "[278]", category: "unknown", xpos: 9, ypos: 7, can_form_compound: false },
            { name: "Darmstadtium", symbol: "Ds", number: 110, atomic_mass: "[281]", category: "unknown", xpos: 10, ypos: 7, can_form_compound: false },
            { name: "Roentgenium", symbol: "Rg", number: 111, atomic_mass: "[282]", category: "unknown", xpos: 11, ypos: 7, can_form_compound: false },
            { name: "Copernicium", symbol: "Cn", number: 112, atomic_mass: "[285]", category: "transition metal", xpos: 12, ypos: 7, can_form_compound: false },
            { name: "Nihonium", symbol: "Nh", number: 113, atomic_mass: "[286]", category: "unknown", xpos: 13, ypos: 7, can_form_compound: false },
            { name: "Flerovium", symbol: "Fl", number: 114, atomic_mass: "[289]", category: "post-transition metal", xpos: 14, ypos: 7, can_form_compound: false },
            { name: "Moscovium", symbol: "Mc", number: 115, atomic_mass: "[290]", category: "unknown", xpos: 15, ypos: 7, can_form_compound: false },
            { name: "Livermorium", symbol: "Lv", number: 116, atomic_mass: "[293]", category: "unknown", xpos: 16, ypos: 7, can_form_compound: false },
            { name: "Tennessine", symbol: "Ts", number: 117, atomic_mass: "[294]", category: "unknown", xpos: 17, ypos: 7, can_form_compound: false },
            { name: "Oganesson", symbol: "Og", number: 118, atomic_mass: "[294]", category: "unknown", xpos: 18, ypos: 7, can_form_compound: false },
            // Lanthanides
            { name: "Cerium", symbol: "Ce", number: 58, atomic_mass: "140.12", category: "lanthanide", xpos: 4, ypos: 9, can_form_compound: false },
            { name: "Praseodymium", symbol: "Pr", number: 59, atomic_mass: "140.91", category: "lanthanide", xpos: 5, ypos: 9, can_form_compound: false },
            { name: "Neodymium", symbol: "Nd", number: 60, atomic_mass: "144.24", category: "lanthanide", xpos: 6, ypos: 9, can_form_compound: false },
            { name: "Promethium", symbol: "Pm", number: 61, atomic_mass: "[145]", category: "lanthanide", xpos: 7, ypos: 9, can_form_compound: false },
            { name: "Samarium", symbol: "Sm", number: 62, atomic_mass: "150.36", category: "lanthanide", xpos: 8, ypos: 9, can_form_compound: false },
            { name: "Europium", symbol: "Eu", number: 63, atomic_mass: "151.96", category: "lanthanide", xpos: 9, ypos: 9, can_form_compound: false },
            { name: "Gadolinium", symbol: "Gd", number: 64, atomic_mass: "157.25", category: "lanthanide", xpos: 10, ypos: 9, can_form_compound: false },
            { name: "Terbium", symbol: "Tb", number: 65, atomic_mass: "158.93", category: "lanthanide", xpos: 11, ypos: 9, can_form_compound: false },
            { name: "Dysprosium", symbol: "Dy", number: 66, atomic_mass: "162.50", category: "lanthanide", xpos: 12, ypos: 9, can_form_compound: false },
            { name: "Holmium", symbol: "Ho", number: 67, atomic_mass: "164.93", category: "lanthanide", xpos: 13, ypos: 9, can_form_compound: false },
            { name: "Erbium", symbol: "Er", number: 68, atomic_mass: "167.26", category: "lanthanide", xpos: 14, ypos: 9, can_form_compound: false },
            { name: "Thulium", symbol: "Tm", number: 69, atomic_mass: "168.93", category: "lanthanide", xpos: 15, ypos: 9, can_form_compound: false },
            { name: "Ytterbium", symbol: "Yb", number: 70, atomic_mass: "173.05", category: "lanthanide", xpos: 16, ypos: 9, can_form_compound: false },
            { name: "Lutetium", symbol: "Lu", number: 71, atomic_mass: "174.97", category: "lanthanide", xpos: 17, ypos: 9, can_form_compound: false },
            // Actinides
            { name: "Thorium", symbol: "Th", number: 90, atomic_mass: "232.04", category: "actinide", xpos: 4, ypos: 10, can_form_compound: false },
            { name: "Protactinium", symbol: "Pa", number: 91, atomic_mass: "231.04", category: "actinide", xpos: 5, ypos: 10, can_form_compound: false },
            { name: "Uranium", symbol: "U", number: 92, atomic_mass: "238.03", category: "actinide", xpos: 6, ypos: 10, can_form_compound: false },
            { name: "Neptunium", symbol: "Np", number: 93, atomic_mass: "[237]", category: "actinide", xpos: 7, ypos: 10, can_form_compound: false },
            { name: "Plutonium", symbol: "Pu", number: 94, atomic_mass: "[244]", category: "actinide", xpos: 8, ypos: 10, can_form_compound: false },
            { name: "Americium", symbol: "Am", number: 95, atomic_mass: "[243]", category: "actinide", xpos: 9, ypos: 10, can_form_compound: false },
            { name: "Curium", symbol: "Cm", number: 96, atomic_mass: "[247]", category: "actinide", xpos: 10, ypos: 10, can_form_compound: false },
            { name: "Berkelium", symbol: "Bk", number: 97, atomic_mass: "[247]", category: "actinide", xpos: 11, ypos: 10, can_form_compound: false },
            { name: "Californium", symbol: "Cf", number: 98, atomic_mass: "[251]", category: "actinide", xpos: 12, ypos: 10, can_form_compound: false },
            { name: "Einsteinium", symbol: "Es", number: 99, atomic_mass: "[252]", category: "actinide", xpos: 13, ypos: 10, can_form_compound: false },
            { name: "Fermium", symbol: "Fm", number: 100, atomic_mass: "[257]", category: "actinide", xpos: 14, ypos: 10, can_form_compound: false },
            { name: "Mendelevium", symbol: "Md", number: 101, atomic_mass: "[258]", category: "actinide", xpos: 15, ypos: 10, can_form_compound: false },
            { name: "Nobelium", symbol: "No", number: 102, atomic_mass: "[259]", category: "actinide", xpos: 16, ypos: 10, can_form_compound: false },
            { name: "Lawrencium", symbol: "Lr", number: 103, atomic_mass: "[262]", category: "actinide", xpos: 17, ypos: 10, can_form_compound: false }
        ];

        // Global state for the game
        let selectedElementsInMix = [];
        let state = 'selecting_first_element'; // States: 'selecting_first_element', 'selecting_second_element', 'compound_formed'

        const elementsContainer = document.getElementById('periodic-table-container');
        const infoPanel = document.getElementById('info-panel');
        const infoMessage = document.getElementById('info-message');
        const elementStats = document.getElementById('element-stats');
        const statName = document.getElementById('stat-name');
        const statSymbol = document.getElementById('stat-symbol');
        const statNumber = document.getElementById('stat-number');
        const statMass = document.getElementById('stat-mass');
        const statCategory = document.getElementById('stat-category');
        const mixZone = document.getElementById('mix-zone');
        const compoundContainer = document.getElementById('compound-container');
        const mixMessage = document.getElementById('mix-message');
        const compoundInfo = document.getElementById('compound-info');
        const compoundName = document.getElementById('compound-name');
        const compoundFormula = document.getElementById('compound-formula');
        const compoundDescription = document.getElementById('compound-description');
        const resetButton = document.getElementById('reset-button');
        const showRecipesButton = document.getElementById('show-recipes-button');
        const recipeBookModal = document.getElementById('recipe-book-modal');
        const closeModalButton = document.getElementById('close-recipes-modal-button');
        const recipesList = document.getElementById('recipes-list');
        const lanthanideLink = document.getElementById('lanthanide-link');
        const actinideLink = document.getElementById('actinide-link');
        const showInfoButton = document.getElementById('show-info-button');
        const infoModal = document.getElementById('info-modal');
        const closeInfoModalButton = document.getElementById('close-info-modal-button');


        /**
         * Creates a single periodic table element tile.
         * @param {object} element - The element data.
         * @returns {HTMLElement} The created div element.
         */
        function createElementTile(element) {
            const tile = document.createElement('div');
            tile.className = `element-tile ${element.category.replace(/\s/g, '-')}`;
            tile.style.gridColumn = element.xpos;
            tile.style.gridRow = element.ypos;
            tile.dataset.symbol = element.symbol;
            tile.innerHTML = `
                <span class="element-number">${element.number}</span>
                <span class="element-symbol">${element.symbol}</span>
                <span class="element-name">${element.name}</span>
            `;
            return tile;
        }

        /**
         * Renders the full periodic table on the page.
         */
        function renderPeriodicTable() {
            elements.forEach(element => {
                const tile = createElementTile(element);
                elementsContainer.appendChild(tile);
            });
            updateCompoundFormingElements();
        }

        /**
         * Highlights elements that can form compounds based on the current game state.
         */
        function updateCompoundFormingElements() {
            // Remove previous active classes
            document.querySelectorAll('.active-element').forEach(el => el.classList.remove('active-element'));

            if (state === 'selecting_first_element') {
                // Highlight elements that can start a compound
                elements.filter(el => el.can_form_compound).forEach(element => {
                    const tile = document.querySelector(`[data-symbol="${element.symbol}"]`);
                    if (tile) {
                        tile.classList.add('active-element');
                    }
                });
            } else if (state === 'selecting_second_element') {
                // Highlight elements that can form a compound with the first selected element
                const firstElement = selectedElementsInMix[0];
                if (firstElement && firstElement.compounds) {
                    firstElement.compounds.forEach(compound => {
                        const tile = document.querySelector(`[data-symbol="${compound.with}"]`);
                        if (tile) {
                            tile.classList.add('active-element');
                        }
                    });
                }
            }
        }

        /**
         * Displays the information for a given element in the info panel.
         * @param {object} element - The element data.
         */
        function showElementInfo(element) {
            infoMessage.classList.add('hidden');
            elementStats.classList.remove('hidden');
            statName.textContent = element.name;
            statSymbol.textContent = element.symbol;
            statNumber.textContent = element.number;
            statMass.textContent = element.atomic_mass;
            statCategory.textContent = element.category;
        }

        /**
         * Adds a selected element to the mix zone.
         * @param {object} element - The element data.
         */
        function addElementToMix(element) {
            if (state === 'compound_formed' || selectedElementsInMix.length >= 2) return;

            const mixTile = document.createElement('div');
            mixTile.className = `element-tile mix-element w-16 h-16`;
            mixTile.innerHTML = `
                <span class="element-symbol">${element.symbol}</span>
                <span class="element-number">${element.number}</span>
            `;
            compoundContainer.appendChild(mixTile);
            mixMessage.classList.add('hidden');
            selectedElementsInMix.push(element);
        }

        /**
         * Checks if the two selected elements form a stable compound.
         */
        function checkCompound() {
            if (selectedElementsInMix.length === 2) {
                const [el1, el2] = selectedElementsInMix.sort((a, b) => a.number - b.number);
                
                // Find a matching compound
                const compound1 = el1.compounds?.find(c => c.with === el2.symbol);
                const compound2 = el2.compounds?.find(c => c.with === el1.symbol);

                if (compound1 || compound2) {
                    const compound = compound1 || compound2;
                    state = 'compound_formed';
                    document.querySelectorAll('.mix-element').forEach(el => el.remove());
                    
                    const compoundTile = document.createElement('div');
                    compoundTile.className = `element-tile w-24 h-24 bg-blue-700 border-blue-500`;
                    compoundTile.innerHTML = `<span class="text-xl font-bold">${compound.formula}</span>`;
                    compoundContainer.appendChild(compoundTile);

                    compoundInfo.classList.remove('hidden');
                    compoundName.textContent = compound.formula;
                    compoundFormula.textContent = `(${el1.symbol} + ${el2.symbol})`;
                    compoundDescription.textContent = compound.compound_info;

                    // Remove all active classes from the periodic table
                    document.querySelectorAll('.active-element').forEach(el => el.classList.remove('active-element'));
                }
            }
        }

        /**
         * Resets the game to its initial state.
         */
        function resetGame() {
            selectedElementsInMix = [];
            state = 'selecting_first_element';
            compoundContainer.innerHTML = `<p id="mix-message" class="text-gray-400 text-sm">Click an active element to add it here.</p>`;
            mixMessage.classList.remove('hidden');
            compoundInfo.classList.add('hidden');
            updateCompoundFormingElements();
        }

        /**
         * Dynamically generates the list of stable compounds for the recipe book.
         */
        function generateRecipesList() {
            recipesList.innerHTML = ''; // Clear previous list
            const uniqueRecipes = new Set();

            elements.forEach(element => {
                if (element.compounds) {
                    element.compounds.forEach(compound => {
                        // Create a unique key for the recipe to prevent duplicates
                        const recipeKey = compound.formula;
                        if (!uniqueRecipes.has(recipeKey)) {
                            uniqueRecipes.add(recipeKey);

                            const li = document.createElement('li');
                            li.className = 'bg-gray-800 p-4 rounded-lg border border-gray-700';
                            li.innerHTML = `
                                <h4 class="text-lg font-bold text-white">${compound.formula}</h4>
                                <p class="text-sm text-gray-400 mt-1">${compound.compound_info}</p>
                            `;
                            recipesList.appendChild(li);
                        }
                    });
                }
            });
        }

        /**
         * Toggles the visibility of the Lanthanide series.
         */
        function toggleLanthanides() {
            const lanthanideElements = document.querySelectorAll('.lanthanide');
            lanthanideElements.forEach(el => {
                // If it has a grid-row, remove it; otherwise, add it.
                if (el.style.gridRow !== 'unset') {
                    el.style.gridRow = 'unset';
                } else {
                    el.style.gridRow = '8'; 
                }
            });
        }
        
        /**
         * Toggles the visibility of the Actinide series.
         */
        function toggleActinides() {
            const actinideElements = document.querySelectorAll('.actinide');
            actinideElements.forEach(el => {
                // If it has a grid-row, remove it; otherwise, add it.
                if (el.style.gridRow !== 'unset') {
                    el.style.gridRow = 'unset';
                } else {
                    el.style.gridRow = '9';
                }
            });
        }

        // Add event listeners once the page is fully loaded
        window.onload = function() {
            renderPeriodicTable();

            elementsContainer.addEventListener('click', (event) => {
                let target = event.target;
                while (target && !target.classList.contains('element-tile')) {
                    target = target.parentNode;
                }

                if (target) {
                    const symbol = target.dataset.symbol;
                    const element = elements.find(el => el.symbol === symbol);

                    if (element) {
                        showElementInfo(element);

                        if (state === 'selecting_first_element' && element.can_form_compound) {
                            document.querySelectorAll('.selected-element').forEach(el => el.classList.remove('selected-element'));
                            target.classList.add('selected-element');

                            addElementToMix(element);
                            state = 'selecting_second_element';
                            updateCompoundFormingElements();
                        } else if (state === 'selecting_second_element' && target.classList.contains('active-element')) {
                            const firstElement = selectedElementsInMix[0];
                            const canCombine = firstElement.compounds?.some(c => c.with === element.symbol);

                            if (canCombine) {
                                addElementToMix(element);
                                checkCompound();
                            }
                        }
                    }
                }
            });

            resetButton.addEventListener('click', resetGame);

            showRecipesButton.addEventListener('click', () => {
                generateRecipesList();
                recipeBookModal.classList.remove('hidden');
            });

            closeModalButton.addEventListener('click', () => {
                recipeBookModal.classList.add('hidden');
            });

            showInfoButton.addEventListener('click', () => {
                infoModal.classList.remove('hidden');
            });

            closeInfoModalButton.addEventListener('click', () => {
                infoModal.classList.add('hidden');
            });

            lanthanideLink.addEventListener('click', toggleLanthanides);
            actinideLink.addEventListener('click', toggleActinides);
        };
    </script>
</body>
</html>
